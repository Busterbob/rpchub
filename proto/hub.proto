syntax = "proto3";

package iota.rpc;

enum ErrorCode {
  UNKNOWN             = 0;
  USER_EXISTS         = 1;
  USER_DOES_NOT_EXIST = 2;
}
message Error {
  ErrorCode code = 1;
}

message CreateUserRequest {
  string identifier = 1;
}

message CreateUserReply {}

message BalanceRequest {
  string uuid = 1;
}

message BalanceReply {
  int64 balance = 1;
}

message DepositAddressRequest {
  string uuid = 1;
}

message DepositAddressReply {
  string address = 1;
}

message UserWithdrawRequest {
  string uuid    = 1;
  string address = 2;
  uint64 amount  = 3;
  string note    = 4;
}

message UserWithdrawReply {
  uint32 error      = 1;
  string bundleHash = 2;
}

message StatsRequest {}

message StatsReply {}

message GetUserHistoryRequest {}

message GetUserHistoryReply {}

message UserBalanceSubscriptionRequest {}

message UserBalanceEvent {}

message ScheduleSweepRequest {}

message ScheduleSweepReply {}


service Hub {
  rpc CreateUser              (CreateUserRequest             ) returns (       CreateUserReply    );
  rpc GetBalance              (BalanceRequest                ) returns (       BalanceReply       );
  rpc GetDepositAddress       (DepositAddressRequest         ) returns (       DepositAddressReply);
  rpc ScheduleSweep           (ScheduleSweepRequest          ) returns (       ScheduleSweepReply );
  rpc UserWithdraw            (UserWithdrawRequest           ) returns (       UserWithdrawReply  );
  rpc GetStats                (StatsRequest                  ) returns (       StatsReply         );
  rpc GetUserHistory          (GetUserHistoryRequest         ) returns (       GetUserHistoryReply);
  rpc UserBalanceSubscription (UserBalanceSubscriptionRequest) returns (stream UserBalanceEvent   );
}

